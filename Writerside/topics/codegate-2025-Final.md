# codegate-2025-Final

7/9/2025~7/12/2025に韓国へcodegate global hacking competitionに行ってきました.

## quals
予選は3/29/2025の9時~24時まででした. 大変健康に良いCTFでした. 予選では上位20人までが決勝に進めます.

ここでカテゴリについて簡単に解説しましょう.
- junior
  - 2007年以降生まれが対象, 個人戦
- pro
  - それ以外, チーム戦

このようなシステムになっているのは韓国での成人年齢に関する問題です. 韓国では日本で言う数え年が広く使われているため, 未成年は2007年生まれ以降となります.
私は運良く早生まれ,2007年3月生まれなのでjuniorで参戦しました.

午前: 11位で昼食を取る

![Screenshot_20251208_001448.png](Screenshot_20251208_001448.png)

21時: 21位まで落ちた. つらスギ

![Screenshot_20251208_001822.png](Screenshot_20251208_001822.png)

1問通し20位ピッタリに

![Screenshot_20251208_001932.png](Screenshot_20251208_001932.png)

そして20位ちょうどで予選を終えました.

![Screenshot_20251208_002009.png](Screenshot_20251208_002009.png)

予選で印象に残った問題はwasmのreversingだと思います. wasm自体はidaでさえpseudoに戻すことが出来ないため`wasi`をよむか, デバッグメインでの解析になります.

wasmメモリダンプなどにかなりの時間をかけ, 比較対象のダンプとそこを参照するxRefを特定, wasmのエンコードロジックを解析し, flagゲットといった流れでした. wasmは人間が読むものじゃないです.

## final

### day 1
finalへ行きましょう. 飛行機は往復3万マイル, 行きはアシアナ,帰りはANAとスターアライアンス忖度で行ってきました.
成田からはアシアナがA380を運行しているらしいので今度韓国に行くときは成田から行きたいですね.

午前4時30分ごろ,学寮を出て羽田へ, そのまま3時間程度の短いフライトでギンポ国際空港着です. ギンポ国際空港の制限エリアを出た後, 竹島の模型にお出迎えを受けました. かなり精巧に作られており, 模型として感銘を受けました. 

その後, ソウル地下鉄でソウル駅まで向かいました. t-moneyという交通系ICカードを作ると便利ということを前々から聞いており, 国際線到着口や地下鉄乗り場で探してみましたが見当たらず, t-moneyはどうやって手に入れるのが正解なんでしょう?

![Screenshot_20251208_004127.png](Screenshot_20251208_004127.png)

(ニコニコな建物を見つけた.)

次の日はCTFのfinalですがお気持ちばかりの観光をします.なるべく効率的に観光地を吸収したいのでタワーに登って上から観察することにし, ソウルタワーへ向かいました.

![Screenshot_20251208_004224.png](Screenshot_20251208_004224.png)

遠そうなので諦めました.

再度,ソウル駅に行き, 4番地下鉄と2番地下鉄で会場のカンナムに向かいました.

![Screenshot_20251208_005004.png](Screenshot_20251208_005004.png)

(カンナムの巨大スクリーン)

![Screenshot_20251208_005058.png](Screenshot_20251208_005058.png)

(会場)

会場は`coex`, 韓国最大のカンファレンスセンターです. 少し下見してその日はホテルへ向かいました. ホテルの枕は一般的な大きさでした.

ここで少しトラブルがあったのですが,前述の通り私は韓国では未成年です. ホテルのチェックインで未成年一人の宿泊が大丈夫なのかというので20分程度いろいろ話し, 説明と誓約書にサインをして無事宿泊が出来ました.

agodaを使って予約したことが若干ネックになった気がするのですが, その国で未成年かつ一人で宿泊する場合は事前にホテルに問い合わせておいたほうが良いとおもいます.

![Screenshot_20251208_005201.png](Screenshot_20251208_005201.png)

`coex`に付属する図書館, 見渡す限りの本, ハングルなので読めない.

夕食はマクドナルドに行きました. 5カ国目のマクド制覇です.

### day 2

決勝の日です. 正直ずっとパソコンに向き合っていたので写真などはありません. juniorは健康的に夜の9時まででした.

![Screenshot_20251208_005447.png](Screenshot_20251208_005447.png)

私のテーブルには学校名+本名の看板が, 長テーブル1つまるごと私のものと, 会場に余裕のあるスペースでした. 余裕のある会場, 殺気立つCTF player, 一体見ていた人はどう感じるのでしょうか?

私が取り組んでいた問題のwriteupもあります.: [](bkernel.md)
linux kernelにkmalloc-1024の自明なUAFがあるkernel moduleが差し込まれ, LPEをしろという問題です.

kmalloc-1024であれば`tty_struct`をかぶせて優勝ルートかと思っていたのですが, `tty_struct`は封じられていました.
`pipe_buffer`をかぶせたあとに`page`構造体を指すメンバを+0x40増やすことでページレベルのmemory corruptionを起こしてpage level uaf,大量にmmapしてマッピングさせることでpteをかぶせて物理メモリへの任意書き込み/読み取りを達成
,setuid内部で呼ばれる関数を書き換え,setuid(0)が不正に通るようにしました.

### day 3

この日はcodegateの表彰式などが午前中に行われました.

![Screenshot_20251208_011126.png](Screenshot_20251208_011126.png)

表彰式では韓国の大臣レベルが2,3人, HUAWEIのCEOが基調講演をしたり, codegateの規模の大きさを改めて実感.

表彰式の時, プレイヤーは前の席に座り,報道陣の見世物になっていたのですが, 以前からdiscordでよくチャットをしていたbroが偶然隣に座っており, 固い握手で国交を開きました.

その他にも, フランスのCTFで知り合った韓国チームと感動の再開を果たしたりとても楽しかったです.

表彰式も終わり, `coex`内の飲食店で冷麺を食べた後, LOTTEタワーへ行きました. 韓国で最も高い建物から効率的観光の実現です.

終わった後に食事会がありましたが,弾丸旅行で疲れすぎていたため食事会は諦めて地下鉄でホテルへ向かいました.

次の日のフライトが早いため空港直結のLOTTEホテルを選びました. 一応高級ホテルの位置づけになっているらしく, 一番安い部屋にも関わらず **t-moneyをプレゼントされました**.
うーん初日に泊まればよかった... 枕の大きさは高級ホテルの名を飾る大きめでした.

### day 4

なんと7時のフライトなので国際線は2時間前ルールに則り5時に空港インしました. しかし保安検査が開いておらず, 若干心配になっていました.

チケット自体は発券出来たのでフライトがあるが,保安検査のゲートがいつまでたっても開かないので眠らないように見張り続けていました.

まぁ開かないわけがないはずで6時頃には保安検査が始まりました. 国際線といえば制限エリア内で長時間すごすイメージがありますが,ギンポでは30分程度しか制限エリア内にいなかったような気がします.

ここでも1つトラブル(?)があり, 土産用に5つ買っていたカップ麺を不審に思われ, バッグを開示しました. 特に問題はありませんでした.

制限エリア内に特に魅力的なところはなく,「ま,いっか」と思いつつ搭乗, ANAの787でゆったり日本に帰国しました.

### summary

ここまで拙い日本語を読んでくれてありがとうございます. 

codegate ctfは毎年juniorの枠があり2026年は2008年以降生まれが対象になります. もし対象ならチャレンジしてみてください.

ところで保安検査に引っかかったカップ麺ですが名前を꼬꼬면(ココ麺)といいます. 韓国で一時期流行った鶏ガラスープのカップ麺ですが, 以前から食べたいと思っており,日本に持ち帰り友達と分けました.

カップ麺にしては量が多く, 友人からも「うん!おいしい!」と好評でした.

こんなカップ麺を大量に持ち帰ろうとする外国人は異常だったはずです. しかし保安検査で指摘はされませんでした. 一体なんでなんでしょうか...?

![Screenshot_20251208_014757.png](Screenshot_20251208_014757.png)

